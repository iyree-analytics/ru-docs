---
title: "Круговые диаграммы (Pie)"
description: "Круговые и кольцевые диаграммы"
---

<img src="/assets/img/charts/pie/pie_example.png" width="600" alt="Пример Pie графика" />

Поддерживает как круговой (pie), так и кольцевой (donut) вид, а также иерархии с drill-down.

### Поля

<ResponseField name="type" type='"pie"' required>
  Тип графика
</ResponseField>

<ResponseField name="pie_type" type="enum" default="pie">
  Вид диаграммы
  
  <Expandable title="Значения">
    | Значение | Описание |
    |----------|----------|
    | `pie` | Круговая диаграмма (заполненная) |
    | `donut` | Кольцевая диаграмма (с отверстием) |
  </Expandable>
</ResponseField>

<ResponseField name="main_measure" type="PieMeasure">
  Основная мера. Используйте либо `main_measure`, либо `selectable_main_measure`.
  
  <Expandable title="Структура PieMeasure">
    <ResponseField name="measure" type="string" required>
      Имя меры из куба
    </ResponseField>
    
    <ResponseField name="title" type="string">
      Заголовок
    </ResponseField>
    
    <ResponseField name="data_point_actions" type="DataPointActionDefinition[]">
      Действия при клике на сектор
      
      <Expandable title="Структура DataPointActionDefinition">
        <ResponseField name="id" type="string" required>
          UUID действия
        </ResponseField>
        <ResponseField name="key" type="string" required>
          Ключ: `common:copy_value` | `common:view_raw_data` | `link:open` | `dashboard:drill_through` | `dashboard:another_dashboard_drill_through`
        </ResponseField>
        <ResponseField name="title" type="string" required>
          Текст в меню
        </ResponseField>
        <ResponseField name="icon" type="IconReference">
          Иконка
        </ResponseField>
        <ResponseField name="target_page_id" type="string">
          UUID целевой страницы
        </ResponseField>
        <ResponseField name="target_dashboard_id" type="string">
          UUID целевого дашборда
        </ResponseField>
        <ResponseField name="filter_mappings" type="DrillThroughFilterMapping[]">
          Маппинг фильтров
        </ResponseField>
        <ResponseField name="url" type="string">
          URL для link:open
        </ResponseField>
        <ResponseField name="open_in" type="enum">
          `same_tab` | `new_tab`
        </ResponseField>
      </Expandable>
    </ResponseField>
  </Expandable>
  
  ```yaml
  main_measure:
    measure: sales.revenue
    title: Выручка
  ```
</ResponseField>

<ResponseField name="selectable_main_measure" type="SelectableMeasureField">
  Выбираемая основная мера
  
  <Expandable title="Структура">
    ```yaml
    selectable_main_measure:
      type: single
      hint: Выберите показатель
      options:
        - measure: sales.revenue
          title: Выручка
        - measure: sales.quantity
          title: Количество
    ```
  </Expandable>
</ResponseField>

<ResponseField name="main_dimension" type="PieDimension">
  Основное измерение (сегменты). Используйте либо `main_dimension`, либо `selectable_main_dimension`.
  
  <Expandable title="Типы PieDimension">
    ### Простое измерение
    
    <ResponseField name="type" type='"dimension"' default="dimension">
      Тип
    </ResponseField>
    
    <ResponseField name="dimension" type="CubeDimension" required>
      Измерение из куба
      
      <Expandable title="Структура CubeDimension">
        **Обычное измерение:**
        ```yaml
        kind: basic
        value: products.category
        ```
        
        **Временное измерение:**
        ```yaml
        kind: time
        value:
          dimension: sales.created_at
          granularity: quarter
        ```
      </Expandable>
    </ResponseField>
    
    <ResponseField name="title" type="string">
      Заголовок
    </ResponseField>
    
    <ResponseField name="colors" type="PieDimensionColors">
      Цвета для значений
      
      <Expandable title="Структура PieDimensionColors">
        <ResponseField name="palette_name" type="string">
          Имя цветовой палитры
        </ResponseField>
        
        <ResponseField name="values" type="Dict[string, string]">
          HEX-цвета для конкретных значений
        </ResponseField>
      </Expandable>
      
      ```yaml
      colors:
        palette_name: custom
        values:
          "Электроника": "#3B82F6"
          "Одежда": "#10B981"
          "Продукты": "#F59E0B"
      ```
    </ResponseField>
    
    ---
    
    ### Иерархия измерений (drill-down)
    
    <ResponseField name="type" type='"dimension_hierarchy"' required>
      Тип
    </ResponseField>
    
    <ResponseField name="levels" type="PieHierarchyLevel[]" required>
      Уровни иерархии
      
      <Expandable title="Структура PieHierarchyLevel">
        <ResponseField name="member" type="CubeDimension" required>
          Измерение уровня
        </ResponseField>
        <ResponseField name="title" type="string">
          Заголовок уровня
        </ResponseField>
        <ResponseField name="colors" type="PieDimensionColors">
          Цвета для уровня
        </ResponseField>
      </Expandable>
      
      ```yaml
      levels:
        - member:
            kind: basic
            value: geography.region
          title: Регион
          colors:
            palette_name: regions
        - member:
            kind: basic
            value: geography.city
          title: Город
      ```
    </ResponseField>
  </Expandable>
  
  ```yaml
  main_dimension:
    dimension:
      kind: basic
      value: products.category
    title: Категория
  ```
</ResponseField>

<ResponseField name="selectable_main_dimension" type="SelectableDimensionField">
  Выбираемое основное измерение
  
  <Expandable title="Структура">
    ```yaml
    selectable_main_dimension:
      type: single
      hint: Выберите разрез
      options:
        - dimension:
            kind: basic
            value: products.category
          title: По категориям
        - dimension:
            kind: basic
            value: products.brand
          title: По брендам
    ```
  </Expandable>
</ResponseField>

<ResponseField name="options" type="PieOptions">
  Настройки отображения
  
  <Expandable title="Структура PieOptions">
    <ResponseField name="label" type="PieLabelOptions">
      Настройки меток на секторах
      
      <Expandable title="Структура PieLabelOptions">
        <ResponseField name="show" type="boolean" default="true">
          Показать метки
        </ResponseField>
        
        <ResponseField name="show_dimension_value" type="boolean" default="true">
          Показать значение измерения (название категории)
        </ResponseField>
        
        <ResponseField name="show_measure_value" type="boolean" default="true">
          Показать значение меры
        </ResponseField>
        
        <ResponseField name="show_percentage" type="boolean" default="true">
          Показать процент от общего
        </ResponseField>
        
        <ResponseField name="position" type="enum" default="outside">
          Позиция меток: `inside` | `outside`
        </ResponseField>
      </Expandable>
      
      ```yaml
      label:
        show: true
        show_dimension_value: true
        show_measure_value: true
        show_percentage: true
        position: outside
      ```
    </ResponseField>
    
    <ResponseField name="legend" type="PieLegendOptions">
      Настройки легенды
      
      <Expandable title="Структура PieLegendOptions">
        <ResponseField name="show" type="boolean" default="true">
          Показать легенду
        </ResponseField>
        
        <ResponseField name="position" type="enum" default="right">
          Позиция: `top` | `bottom` | `left` | `right`
        </ResponseField>
      </Expandable>
      
      ```yaml
      legend:
        show: true
        position: right
      ```
    </ResponseField>
  </Expandable>
</ResponseField>

<ResponseField name="compare_period_enabled" type="boolean" default="false">
  Сравнение периодов
</ResponseField>

### Примеры

<CodeGroup>

```yaml Простая круговая
type: pie
pie_type: pie
main_dimension:
  dimension:
    kind: basic
    value: products.category
  title: Категория
main_measure:
  measure: sales.revenue
  title: Выручка
```

```yaml Кольцевая (donut)
type: pie
pie_type: donut
main_dimension:
  dimension:
    kind: basic
    value: products.category
  title: Категория
  colors:
    palette_name: categories
    values:
      "Электроника": "#3B82F6"
      "Одежда": "#10B981"
      "Продукты": "#F59E0B"
      "Прочее": "#9CA3AF"
main_measure:
  measure: sales.revenue
  title: Выручка
options:
  label:
    show: true
    show_percentage: true
    position: outside
  legend:
    show: true
    position: right
```

```yaml С иерархией (drill-down)
type: pie
pie_type: pie
main_dimension:
  type: dimension_hierarchy
  levels:
    - member:
        kind: basic
        value: geography.region
      title: Регион
    - member:
        kind: basic
        value: geography.city
      title: Город
    - member:
        kind: basic
        value: stores.name
      title: Магазин
main_measure:
  measure: sales.revenue
  title: Выручка
  data_point_actions:
    - id: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
      key: "common:view_raw_data"
      title: "Исходные данные"
```

```yaml С выбираемыми полями
type: pie
pie_type: donut

selectable_main_dimension:
  type: single
  hint: Разрез
  options:
    - dimension:
        kind: basic
        value: products.category
      title: По категориям
    - dimension:
        kind: basic
        value: products.brand
      title: По брендам
    - dimension:
        kind: basic
        value: managers.name
      title: По менеджерам

selectable_main_measure:
  type: single
  hint: Показатель
  options:
    - measure: sales.revenue
      title: Выручка
    - measure: sales.quantity
      title: Количество
    - measure: orders.count
      title: Заказы

options:
  legend:
    show: true
    position: bottom
```

```yaml С действиями (drill-through)
type: pie
pie_type: pie
main_dimension:
  dimension:
    kind: basic
    value: products.category
  title: Категория
main_measure:
  measure: sales.revenue
  title: Выручка
  data_point_actions:
    - id: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
      key: "dashboard:drill_through"
      title: "Товары категории"
      target_page_id: "a1b2c3d4-5678-90ab-cdef-1234567890ab"
      filter_mappings:
        - target_filter_id: "b2c3d4e5-6789-01bc-def0-234567890abc"
          sources:
            - type: data_point_dimension
              member_name: products.category
```

</CodeGroup>

---

## См. также

<CardGroup cols={2}>
  <Card title="Иерархии измерений" icon="sitemap" href="../features/dimension-hierarchy">
    Drill-down в диаграммах
  </Card>
  <Card title="Действия с данными" icon="mouse-pointer-click" href="../features/data-point-actions">
    Клики и drill-through
  </Card>
  <Card title="Выбираемые поля" icon="list-check" href="../features/selectable-fields">
    Динамический выбор
  </Card>
</CardGroup>

---

← [Столбчатые диаграммы](./bar) | → [Динамические графики](./dynamic)
